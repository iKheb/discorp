<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discorp - Portafolio</title>
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="https://placehold.co/32x32/8B5CF6/ffffff?text=DC">
    <!-- Tailwind CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <!-- Font Awesome Icons CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Google Fonts CDN - Inter (Modern) y Rubik (Para énfasis) -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Rubik:wght@500;700&display=swap" rel="stylesheet">
    <style>
        /* Definición de variables CSS para temas claro y oscuro */
        :root {
            /* Colores y fondos para el modo claro */
            --bg-body-primary: linear-gradient(to right top, #edf2f7, #e2e8f0);
            --text-color: #334155;
            --card-bg: #ffffff;
            --navbar-bg: #ffffff;
            --shadow-base: rgba(0,0,0,0.08);
            --shadow-hover: rgba(0,0,0,0.12);
            --link-color: #4A5568; /* gray-700 */
            --link-hover-color: #4F46E5; /* indigo-600 */
            --input-border: #d1d5db; /* gray-300 */
            --input-focus-ring: #3b82f6; /* blue-500 */
            --input-focus-border: #3b82f6; /* blue-500 */
            --section-bg: #ffffff; /* Background for main sections like projects, about */
            --section-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* shadow-lg */
        }

        body.dark-mode {
            /* Colores y fondos para el modo oscuro */
            --bg-body-primary: linear-gradient(to right top, #1a202c, #2d3748); /* Darker blue-gray */
            --text-color: #e2e8f0; /* Light gray for text */
            --card-bg: #2d3748; /* Dark background for cards */
            --navbar-bg: #1a202c; /* Dark navbar */
            --shadow-base: rgba(0,0,0,0.3); /* Darker shadows */
            --shadow-hover: rgba(0,0,0,0.5);
            --link-color: #A0AEC0; /* gray-400 */
            --link-hover-color: #6366F1; /* indigo-500 */
            --input-border: #4a5568; /* darker gray for inputs */
            --input-focus-ring: #6366F1; /* darker blue for focus */
            --input-focus-border: #6366F1;
            --section-bg: #1a202c; /* Dark background for main sections */
            --section-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.15);
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-body-primary);
            color: var(--text-color);
            overflow-x: hidden; /* Evita el scroll horizontal */
            transition: background 0.5s ease, color 0.5s ease; /* Transición suave para el tema */
        }
        h1, h2, h3 {
            font-family: 'Rubik', sans-serif; /* Fuente para encabezados con más impacto */
        }
        .text-gradient-purple-blue {
            /* Degradado vibrante para títulos principales */
            background: linear-gradient(to right, #8B5CF6, #4F46E5); /* Púrpura a Azul índigo */
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .btn-primary {
            /* Estilo para botón principal con degradado y sombra */
            background: linear-gradient(to right, #6EE7B7, #3B82F6); /* Verde a Azul */
            box-shadow: 0 4px 14px 0 rgba(59, 130, 246, 0.3);
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            box-shadow: 0 6px 20px 0 rgba(59, 130, 246, 0.4);
            transform: translateY(-2px);
        }
        .project-card {
            /* Estilo base para las tarjetas de proyecto */
            border-radius: 1rem; /* Bordes redondeados más pronunciados */
            background-color: var(--card-bg);
            box-shadow: 0 5px 15px var(--shadow-base); /* Sombra suave */
            transition: all 0.3s ease;
        }
        .project-card:hover {
            transform: translateY(-5px) scale(1.01); /* Pequeño levantamiento y escala al pasar el ratón */
            box-shadow: 0 8px 25px var(--shadow-hover); /* Sombra más pronunciada al pasar el ratón */
        }

        /* Animaciones generales */
        .animate-zoom-in {
            animation: zoomIn 0.8s ease-out forwards;
            opacity: 0;
            transform: scale(0.9);
        }
        .animate-slide-left {
            animation: slideLeft 0.8s ease-out forwards;
            opacity: 0;
            transform: translateX(-20px);
        }
        .animate-slide-right {
            animation: slideRight 0.8s ease-out forwards;
            opacity: 0;
            transform: translateX(20px);
        }
        @keyframes zoomIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        @keyframes slideLeft {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        @keyframes slideRight {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        /* Estilos para el scrollbar personalizado (solo para navegadores WebKit) */
        ::-webkit-scrollbar {
            width: 10px; /* Ancho de la barra de desplazamiento */
        }
        ::-webkit-scrollbar-track {
            background: var(--bg-body-primary); /* Color del fondo de la barra, coincide con el fondo del body */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #aab8d0; /* Color del "pulgar" de la barra de desplazamiento */
            border-radius: 10px;
            border: 2px solid var(--bg-body-primary); /* Borde para que coincida con el fondo del track */
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #8b9bbd; /* Color al pasar el mouse por el "pulgar" */
        }

        /* Animación de carga */
        #loader-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-body-primary); /* Color de fondo claro, similar al body */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999; /* Asegura que esté por encima de todo */
            transition: opacity 0.5s ease-out, background 0.5s ease;
            opacity: 1;
        }

        .loader {
            border: 8px solid #cbd5e0; /* Gris claro */
            border-top: 8px solid #4F46E5; /* Azul índigo vibrante */
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1.2s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Estilos para Modales */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7); /* Fondo oscuro semitransparente */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000; /* Por encima de todo lo demás */
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background-color: var(--card-bg); /* Usa el color de fondo de la tarjeta para modales */
            padding: 2.5rem;
            border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            width: 90%;
            max-width: 500px; /* Max width for login modal */
            position: relative;
            transform: translateY(-20px);
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease, background-color 0.5s ease; /* Transición para tema */
            max-height: 90vh; /* Default max height for modals */
            overflow-y: auto; /* Enable scrolling for modals */
            color: var(--text-color); /* Asegura que el texto dentro del modal también cambie de color */
        }
        #dashboard-modal .modal-content,
        #edit-project-modal .modal-content { /* Aplicar estilos al nuevo modal también */
            max-width: 95%; /* Adjust max-width for dashboard modal */
            width: 95%; /* Make dashboard modal wider */
            max-height: 95vh; /* Adjust max-height for dashboard modal */
            padding: 2rem; /* Adjust padding for dashboard modal */
        }
        .modal-overlay.active .modal-content {
            transform: translateY(0);
            opacity: 1;
        }
        .modal-close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--link-color); /* Color del icono de cerrar basado en el tema */
            cursor: pointer;
            transition: color 0.2s ease;
        }
        .modal-close-btn:hover {
            color: var(--link-hover-color);
        }

        /* Estilos para el Navbar y sus elementos para el tema */
        nav {
            background-color: var(--navbar-bg);
            box-shadow: 0 4px 6px -1px var(--shadow-base), 0 2px 4px -1px rgba(0, 0, 0, 0.06); /* Simula shadow-md de Tailwind */
            transition: background-color 0.5s ease, box-shadow 0.5s ease;
        }
        nav a, nav button {
            color: var(--link-color);
            transition: color 0.3s ease;
        }
        nav a:hover, nav button:hover {
            color: var(--link-hover-color);
        }
        /* Ajuste para el color del texto del search input */
        #project-search-input {
            background-color: var(--card-bg);
            border-color: var(--input-border);
            color: var(--text-color);
            transition: background-color 0.5s ease, border-color 0.5s ease, color 0.5s ease;
        }
        #project-search-input:focus {
            border-color: var(--input-focus-border);
            box-shadow: 0 0 0 2px var(--input-focus-ring);
        }
        .fa-search {
            color: var(--link-color); /* Color del icono de búsqueda */
        }

        /* Secciones principales también deben reaccionar al tema */
        #proyectos, #acerca-de-mi {
            background-color: var(--section-bg);
            box-shadow: var(--section-shadow);
            transition: background-color 0.5s ease, box-shadow 0.5s ease;
        }
        /* Color del texto dentro de formularios y mensajes */
        input, textarea {
            background-color: var(--card-bg);
            border-color: var(--input-border);
            color: var(--text-color);
            transition: background-color 0.5s ease, border-color 0.5s ease, color 0.5s ease;
        }
        input:focus, textarea:focus {
            border-color: var(--input-focus-border);
            box-shadow: 0 0 0 2px var(--input-focus-ring);
        }
        .text-gray-700, .text-gray-800, .text-gray-900 {
            color: var(--text-color); /* Asegurar que estos textos también cambian */
        }
        .text-gray-500 {
            color: var(--link-color); /* para textos grises más claros */
        }
        .bg-gray-50 { /* Para elementos como los items del dashboard */
            background-color: var(--card-bg);
            transition: background-color 0.5s ease;
        }
    </style>
</head>
<body class="antialiased leading-normal" oncontextmenu="return false;">

    <!-- Animación de Carga -->
    <div id="loader-overlay">
        <div class="loader"></div>
    </div>

    <!-- Navbar -->
    <nav class="py-4 px-6 md:px-12 fixed w-full z-20">
        <div class="container mx-auto flex justify-between items-center">
            <a href="#" class="text-3xl font-bold text-gradient-purple-blue animate-zoom-in">Discorp</a>
            <ul class="flex space-x-6 items-center">
                <li><a href="#proyectos" class="scroll-link">Proyectos</a></li>
                <li><a href="#habilidades" class="scroll-link">Habilidades</a></li>
                <li><a href="#acerca-de-mi" class="scroll-link">Acerca de Mí</a></li>
                <li>
                    <button id="open-contact-modal-btn" class="transition duration-300 focus:outline-none">
                        Contacto
                    </button>
                </li>
                <!-- Search bar in the middle -->
                <li class="flex-grow flex justify-center px-4">
                    <div class="relative w-full max-w-md">
                        <input type="text" id="project-search-input" placeholder="Buscar proyectos..."
                               class="w-full pl-10 pr-4 py-2 border rounded-full focus:outline-none focus:ring-2 focus:border-transparent transition duration-300">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fas fa-search"></i>
                        </div>
                    </div>
                </li>
                <li>
                    <button id="theme-toggle-btn" class="transition duration-300 text-xl focus:outline-none">
                        <i class="fas fa-moon"></i> <!-- Icono inicial (Luna para indicar que se puede cambiar a modo oscuro) -->
                    </button>
                </li>
                <li id="admin-icon-nav-item">
                    <button id="open-login-modal-btn" class="transition duration-300 text-xl focus:outline-none">
                        <i class="fas fa-cog"></i>
                    </button>
                </li>
                <li id="dashboard-nav-item" class="hidden">
                    <button id="open-dashboard-modal-btn" class="transition duration-300 focus:outline-none">
                        Dashboard
                    </button>
                </li>
            </ul>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="min-h-screen flex items-center justify-center text-center py-20 px-4 pt-32 bg-gradient-to-br from-indigo-50 to-blue-100">
        <div class="max-w-4xl mx-auto">
            <h1 class="text-6xl md:text-8xl font-extrabold leading-tight mb-6 text-gradient-purple-blue animate-zoom-in">
                Construyendo <br class="hidden md:block"> el futuro digital.
            </h1>
            <p class="text-xl md:text-2xl mb-10 animate-slide-left" style="animation-delay: 0.3s;">
                Una colección de mis trabajos en desarrollo web y aplicaciones.
            </p>
            <a href="#proyectos" class="inline-block btn-primary text-white font-bold py-4 px-10 rounded-full text-lg transition duration-300 animate-slide-right scroll-link" style="animation-delay: 0.6s;">
                Explorar Trabajos <i class="fas fa-code ml-3"></i>
            </a>
        </div>
    </section>

    <!-- Proyectos Section -->
    <section id="proyectos" class="py-20 px-4 shadow-lg z-10 relative">
        <div class="container mx-auto">
            <h2 class="text-5xl font-bold text-center mb-16 text-gradient-purple-blue animate-zoom-in">Mis Últimos Proyectos</h2>
            <div id="projects-container" class="grid md:grid-cols-2 lg:grid-cols-3 gap-10">
                <!-- Los proyectos se cargarán aquí dinámicamente desde Firestore -->
                <p class="text-center col-span-full">Cargando proyectos...</p>
            </div>
        </div>
    </section>

    <!-- Habilidades Section -->
    <section id="habilidades" class="py-20 px-4">
        <div class="container mx-auto max-w-4xl text-center">
            <h2 class="text-5xl font-bold mb-12 text-gradient-purple-blue animate-zoom-in">Mis Habilidades</h2>
            <div class="flex flex-wrap justify-center gap-6 animate-slide-left" style="animation-delay: 0.2s;">
                <span class="bg-white text-gray-800 px-6 py-3 rounded-full text-lg font-semibold shadow-md transition duration-300 hover:scale-105">HTML5 <i class="fab fa-html5 ml-2"></i></span>
                <span class="bg-white text-gray-800 px-6 py-3 rounded-full text-lg font-semibold shadow-md transition duration-300 hover:scale-105">CSS3 <i class="fab fa-css3-alt ml-2"></i></span>
                <span class="bg-white text-gray-800 px-6 py-3 rounded-full text-lg font-semibold shadow-md transition duration-300 hover:scale-105">JavaScript <i class="fab fa-js-square ml-2"></i></span>
                <span class="bg-white text-gray-800 px-6 py-3 rounded-full text-lg font-semibold shadow-md transition duration-300 hover:scale-105">PHP <i class="fab fa-php ml-2"></i></span>
                <span class="bg-white text-gray-800 px-6 py-3 rounded-full text-lg font-semibold shadow-md transition duration-300 hover:scale-105">Tailwind CSS <i class="fas fa-wind ml-2"></i></span>
                <span class="bg-white text-gray-800 px-6 py-3 rounded-full text-lg font-semibold shadow-md transition duration-300 hover:scale-105">Base de Datos <i class="fas fa-database ml-2"></i></span>
                <span class="bg-white text-gray-800 px-6 py-3 rounded-full text-lg font-semibold shadow-md transition duration-300 hover:scale-105">UI/UX Design <i class="fas fa-palette ml-2"></i></span>
                <span class="bg-white text-gray-800 px-6 py-3 rounded-full text-lg font-semibold shadow-md transition duration-300 hover:scale-105">Control de Versiones (Git) <i class="fab fa-git-alt ml-2"></i></span>
            </div>
        </div>
    </section>

    <!-- Acerca de Mí Section -->
    <section id="acerca-de-mi" class="py-20 px-4 shadow-inner">
        <div class="container mx-auto max-w-3xl text-center">
            <h2 class="text-5xl font-bold mb-10 text-gradient-purple-blue animate-zoom-in">Acerca de Mí</h2>
            <p class="text-lg mb-6 animate-slide-right" style="animation-delay: 0.2s;">
                Soy un desarrollador web apasionado con experiencia en la creación de soluciones digitales atractivas y funcionales. Mi enfoque principal es construir experiencias de usuario intuitivas y robustas, utilizando las últimas tecnologías.
            </p>
            <p class="text-lg animate-slide-left" style="animation-delay: 0.4s;">
                Me encanta transformar ideas en realidad a través del código, siempre buscando aprender y aplicar nuevas herramientas para superar los desafíos. Mi objetivo es crear impacto y valor en cada proyecto.
            </p>
        </div>
    </section>

    <!-- Login Modal -->
    <div id="login-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="modal-close-btn" id="close-login-modal-btn">&times;</button>
            <h2 class="text-4xl font-bold mb-8 text-gradient-purple-blue">Iniciar Sesión</h2>
            <form id="login-form" class="space-y-6">
                <div>
                    <label for="login-email" class="sr-only">Correo Electrónico</label>
                    <input type="email" id="login-email" name="email" class="w-full p-3 border rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-300" placeholder="Correo Electrónico" required>
                </div>
                <div>
                    <label for="login-password" class="sr-only">Contraseña</label>
                    <input type="password" id="login-password" name="password" class="w-full p-3 border rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-300" placeholder="Contraseña" required>
                </div>
                <button type="submit" class="w-full btn-primary text-white font-bold py-3 px-6 rounded-full text-lg shadow-lg transition duration-300">
                    Acceder al Dashboard <i class="fas fa-sign-in-alt ml-2"></i>
                </button>
                <p id="login-message" class="text-center mt-4 text-sm"></p>
            </form>
        </div>
    </div>

    <!-- Contact Modal -->
    <div id="contact-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="modal-close-btn" id="close-contact-modal-btn">&times;</button>
            <h2 class="text-4xl font-bold mb-8 text-gradient-purple-blue">Contáctame</h2>
            <p class="text-lg mb-8">
                Si tienes un proyecto interesante o simplemente quieres saludar, no dudes en contactarme.
            </p>
            <form id="contact-form-modal" action="#" method="POST" class="space-y-6">
                <div>
                    <input type="text" id="nombre-contact-modal" name="nombre" placeholder="Tu Nombre Completo" class="w-full p-4 border rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-300" required>
                </div>
                <div>
                    <input type="email" id="email-contact-modal" name="email" placeholder="Tu Correo Electrónico" class="w-full p-4 border rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-300" required>
                </div>
                <div>
                    <textarea id="mensaje-contact-modal" name="mensaje" rows="7" placeholder="Tu Mensaje..." class="w-full p-4 border rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-300" required></textarea>
                </div>
                <button type="submit" class="w-full btn-primary text-white font-bold py-4 px-8 rounded-full text-lg transition duration-300">
                    Enviar Mensaje <i class="fas fa-paper-plane ml-3"></i>
                </button>
                <p id="contact-message" class="text-center mt-4 text-sm"></p>
            </form>
        </div>
    </div>

    <!-- Dashboard Modal -->
    <div id="dashboard-modal" class="modal-overlay hidden">
        <div class="modal-content !max-w-3xl !p-8">
            <button class="modal-close-btn" id="close-dashboard-modal-btn">&times;</button>
            <h2 class="text-5xl font-bold text-center mb-10 text-gradient-purple-blue">Dashboard de Proyectos</h2>
            <p class="text-center mb-8">Agrega o gestiona tus proyectos aquí. Tu ID de usuario: <span id="current-user-id" class="font-bold text-blue-600 break-all"></span></p>

            <div class="p-8 rounded-lg shadow-md mb-10">
                <h3 class="text-3xl font-bold mb-6">Agregar Nuevo Proyecto</h3>
                <form id="add-project-form" class="space-y-6">
                    <div>
                        <label for="project-title" class="block text-sm font-bold mb-2">Título del Proyecto:</label>
                        <input type="text" id="project-title" name="title" class="w-full p-3 border rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-300" placeholder="Ej: Mi Aplicación de Notas" required>
                    </div>
                    <div>
                        <label for="project-description" class="block text-sm font-bold mb-2">Descripción:</label>
                        <textarea id="project-description" name="description" rows="4" class="w-full p-3 border rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-300" placeholder="Describe tu proyecto..." required></textarea>
                    </div>
                    <div>
                        <label for="project-image" class="block text-sm font-bold mb-2">URL de la Imagen:</label>
                        <input type="url" id="project-image" name="image" class="w-full p-3 border rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-300" placeholder="Ej: https://placehold.co/600x400/8B5CF6/ffffff?text=Mi+App" required>
                    </div>
                    <div>
                        <label for="project-github" class="block text-sm font-bold mb-2">URL de GitHub:</label>
                        <input type="url" id="project-github" name="github" class="w-full p-3 border rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-300" placeholder="Ej: https://github.com/tu_usuario/mi-proyecto" required>
                    </div>
                    <div>
                        <label for="project-demo-url" class="block text-sm font-bold mb-2">URL de la Demo (Opcional):</label>
                        <input type="url" id="project-demo-url" name="demoUrl" class="w-full p-3 border rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-300" placeholder="Ej: https://mi-proyecto-demo.com">
                    </div>
                    <div>
                        <label for="project-techs" class="block text-sm font-bold mb-2">Tecnologías (separadas por comas):</label>
                        <input type="text" id="project-techs" name="technologies" class="w-full p-3 border rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-300" placeholder="Ej: PHP, JavaScript, Tailwind CSS" required>
                    </div>
                    <button type="submit" class="w-full btn-primary text-white font-bold py-3 px-6 rounded-full text-lg shadow-lg transition duration-300">
                        Agregar Proyecto <i class="fas fa-plus-circle ml-2"></i>
                    </button>
                    <p id="dashboard-message" class="text-center mt-4 text-sm"></p>
                </form>
            </div>

            <div class="p-8 rounded-lg shadow-md">
                <h3 class="text-3xl font-bold mb-6">Proyectos Actuales</h3>
                <div id="current-projects-list" class="space-y-4">
                    <p>Cargando proyectos del dashboard...</p>
                    <!-- Los proyectos del dashboard se cargarán aquí -->
                </div>
            </div>
            <button id="logout-btn" class="mt-8 w-full bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-6 rounded-full shadow-lg transition duration-300">
                Cerrar Sesión <i class="fas fa-sign-out-alt ml-2"></i>
            </button>
        </div>
    </div>

    <!-- Edit Project Modal -->
    <div id="edit-project-modal" class="modal-overlay hidden">
        <div class="modal-content !max-w-3xl !p-8">
            <button class="modal-close-btn" id="close-edit-project-modal-btn">&times;</button>
            <h2 class="text-5xl font-bold text-center mb-10 text-gradient-purple-blue">Editar Proyecto</h2>
            <form id="edit-project-form" class="space-y-6">
                <input type="hidden" id="edit-project-id">
                <div>
                    <label for="edit-project-title" class="block text-sm font-bold mb-2">Título del Proyecto:</label>
                    <input type="text" id="edit-project-title" name="title" class="w-full p-3 border rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-300" required>
                </div>
                <div>
                    <label for="edit-project-description" class="block text-sm font-bold mb-2">Descripción:</label>
                    <textarea id="edit-project-description" name="description" rows="4" class="w-full p-3 border rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-300" required></textarea>
                </div>
                <div>
                    <label for="edit-project-image" class="block text-sm font-bold mb-2">URL de la Imagen:</label>
                    <input type="url" id="edit-project-image" name="image" class="w-full p-3 border rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-300" required>
                </div>
                <div>
                    <label for="edit-project-github" class="block text-sm font-bold mb-2">URL de GitHub:</label>
                    <input type="url" id="edit-project-github" name="github" class="w-full p-3 border rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-300" required>
                </div>
                <div>
                    <label for="edit-project-demo-url" class="block text-sm font-bold mb-2">URL de la Demo (Opcional):</label>
                    <input type="url" id="edit-project-demo-url" name="demoUrl" class="w-full p-3 border rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-300">
                </div>
                <div>
                    <label for="edit-project-techs" class="block text-sm font-bold mb-2">Tecnologías (separadas por comas):</label>
                    <input type="text" id="edit-project-techs" name="technologies" class="w-full p-3 border rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-300" required>
                </div>
                <button type="submit" class="w-full btn-primary text-white font-bold py-3 px-6 rounded-full text-lg shadow-lg transition duration-300">
                    Guardar Cambios <i class="fas fa-save ml-2"></i>
                </button>
                <p id="edit-dashboard-message" class="text-center mt-4 text-sm"></p>
            </form>
        </div>
    </div>


    <!-- Footer -->
    <footer class="bg-gray-900 text-gray-300 py-10 px-4 text-center">
        <div class="container mx-auto">
            <!-- PHP para mostrar el año actual dinámicamente -->
            <p class="mb-4">&copy; <?php echo date("Y"); ?> DISCORP - Todos los derechos reservados.</p>
            <div class="flex justify-center space-x-6">
                <a href="https://github.com/tu_usuario" target="_blank" class="text-gray-400 hover:text-white transition duration-300" title="Mi GitHub">
                    <i class="fab fa-github text-3xl"></i>
                </a>
                <a href="#" target="_blank" class="text-gray-400 hover:text-white transition duration-300" title="Mi LinkedIn">
                    <i class="fab fa-linkedin text-3xl"></i>
                </a>
                <a href="mailto:tu.correo@example.com" class="text-gray-400 hover:text-white transition duration-300" title="Enviar Correo">
                    <i class="fas fa-envelope text-3xl"></i>
                </a>
            </div>
            <p class="mt-6 text-sm text-gray-500">Diseñado con <i class="fas fa-heart text-red-500 mx-1"></i> y para todos ustedes.</p>
        </div>
    </footer>

    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, doc, deleteDoc, updateDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        let db;
        let auth;
        let userId = null; // Se inicializará con el UID del usuario autenticado o null
        let allProjects = []; // Almacenará la lista completa de proyectos sin filtrar

        // TU CONFIGURACIÓN DE FIREBASE
        const firebaseConfig = {
            apiKey: "AIzaSyAjqPMMWS1Aito2A_Fubcl56tGRSYWFrMY",
            authDomain: "portafolio-370fc.firebaseapp.com",
            projectId: "portafolio-370fc",
            storageBucket: "portafolio-370fc.firebasestorage.app",
            messagingSenderId: "997794107628",
            appId: "1:997794107628:web:8288aafed8d02c642655c9"
        };
        const appId = "portafolio-370fc"; // Usando projectId como appId para la colección de Firestore

        // ! IMPORTANTE: Reemplaza 'YOUR_ADMIN_FIREBASE_UID_HERE' con tu UID real de Firebase Auth.
        // ! Necesitas crear un usuario de correo/contraseña en tu proyecto de Firebase y obtener su UID.
        // ! Puedes obtener tu UID una vez que inicies sesión exitosamente e imprimas 'auth.currentUser.uid' en la consola.
        const ADMIN_USER_ID = 'rljOhUjnvne1p1qDhk29io139xc2'; // <-- Reemplaza esto con tu UID

        // Referencias a los elementos del DOM
        const adminIconNavItem = document.getElementById('admin-icon-nav-item');
        const dashboardNavItem = document.getElementById('dashboard-nav-item');
        const openLoginModalBtn = document.getElementById('open-login-modal-btn');
        const openDashboardModalBtn = document.getElementById('open-dashboard-modal-btn');
        const loginModal = document.getElementById('login-modal');
        const closeLoginModalBtn = document.getElementById('close-login-modal-btn');
        const dashboardModal = document.getElementById('dashboard-modal');
        const closeDashboardModalBtn = document.getElementById('close-dashboard-modal-btn');
        const loginForm = document.getElementById('login-form');
        const loginMessage = document.getElementById('login-message');
        const addProjectForm = document.getElementById('add-project-form');
        const dashboardMessage = document.getElementById('dashboard-message');
        const logoutBtn = document.getElementById('logout-btn');

        // Nuevas referencias para el modal de contacto
        const openContactModalBtn = document.getElementById('open-contact-modal-btn');
        const closeContactModalBtn = document.getElementById('close-contact-modal-btn');
        const contactModal = document.getElementById('contact-modal');
        const contactFormModal = document.getElementById('contact-form-modal');
        const contactMessage = document.getElementById('contact-message');

        // Referencias para el nuevo modal de edición
        const editProjectModal = document.getElementById('edit-project-modal');
        const closeEditProjectModalBtn = document.getElementById('close-edit-project-modal-btn');
        const editProjectForm = document.getElementById('edit-project-form');
        const editProjectId = document.getElementById('edit-project-id');
        const editProjectTitle = document.getElementById('edit-project-title');
        const editProjectDescription = document.getElementById('edit-project-description');
        const editProjectImage = document.getElementById('edit-project-image');
        const editProjectGithub = document.getElementById('edit-project-github');
        const editProjectDemoUrl = document.getElementById('edit-project-demo-url');
        const editProjectTechs = document.getElementById('edit-project-techs');
        const editDashboardMessage = document.getElementById('edit-dashboard-message'); // Mensaje para el modal de edición

        // Referencia para el buscador
        const projectSearchInput = document.getElementById('project-search-input');

        // Referencia para el botón de cambio de tema
        const themeToggleBtn = document.getElementById('theme-toggle-btn');


        // Esta variable se inicializará DESPUÉS de que db esté disponible.
        let publicProjectsCollectionRef;


        // Funciones para manejar la visibilidad de los modales
        function openModal(modalElement) {
            modalElement.classList.add('active');
            document.body.style.overflow = 'hidden'; // Deshabilitar scroll del body
        }

        function closeModal(modalElement) {
            modalElement.classList.remove('active');
            document.body.style.overflow = ''; // Habilitar scroll del body
        }

        // Función para actualizar la visibilidad de los botones de navegación y modales
        function updateAdminUI(isAdmin) {
            if (isAdmin) {
                adminIconNavItem.classList.add('hidden');
                dashboardNavItem.classList.remove('hidden');
            } else {
                adminIconNavItem.classList.remove('hidden');
                dashboardNavItem.classList.add('hidden');
                closeModal(dashboardModal); // Asegurarse de que el dashboard modal esté cerrado
            }
        }

        // Función para renderizar los proyectos en la sección principal
        function renderProjects(projectsToRender) { // Cambiado el nombre del parámetro
            const projectsContainer = document.getElementById('projects-container');
            projectsContainer.innerHTML = ''; // Limpiar proyectos existentes

            // Ordenar proyectos por createdAt en orden descendente (los más nuevos primero)
            projectsToRender.sort((a, b) => (b.createdAt?.toDate() || 0) - (a.createdAt?.toDate() || 0));


            if (projectsToRender.length === 0) {
                projectsContainer.innerHTML = '<p class="text-center col-span-full">No hay proyectos para mostrar.</p>';
                return;
            }

            projectsToRender.forEach(project => {
                const projectCard = `
                    <div class="project-card p-8 animate-slide-up">
                        <img src="${project.image}" onerror="this.onerror=null;this.src='https://placehold.co/600x400/cccccc/333333?text=Sin+Imagen';" alt="${project.title}" class="rounded-lg mb-6 w-full object-cover h-48">
                        <h3 class="text-2xl font-semibold mb-3">${project.title}</h3>
                        <p class="mb-5">${project.description}</p>
                        <div class="flex flex-wrap gap-2 mb-5">
                            ${(project.technologies || []).map(tech => `<span class="bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full">${tech}</span>`).join('')}
                        </div>
                        <div class="flex justify-between items-center mt-4">
                            <a href="${project.github}" target="_blank" class="text-blue-600 hover:text-blue-800 hover:underline flex items-center font-medium">
                                Ver Código <i class="fab fa-github ml-2"></i>
                            </a>
                            ${project.demoUrl ? `<a href="${project.demoUrl}" target="_blank" class="ml-4 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-full text-sm shadow-md transition duration-300">
                                Demo <i class="fas fa-external-link-alt ml-2"></i>
                            </a>` : ''}
                        </div>
                    </div>
                `;
                projectsContainer.insertAdjacentHTML('beforeend', projectCard);
            });
        }

        // Función para renderizar proyectos en el dashboard
        function renderDashboardProjects(projects) {
            const currentProjectsList = document.getElementById('current-projects-list');
            currentProjectsList.innerHTML = ''; // Limpiar proyectos existentes

            if (projects.length === 0) {
                currentProjectsList.innerHTML = '<p>No hay proyectos agregados aún.</p>';
                return;
            }

            projects.forEach(project => {
                const projectItem = `
                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg shadow-sm">
                        <div class="flex-1 flex items-center">
                            <!-- Project Image Preview -->
                            <img src="${project.image}" onerror="this.onerror=null;this.src='https://placehold.co/50x50/cccccc/333333?text=IMG';" alt="Project Image" class="w-12 h-12 rounded-lg object-cover mr-4">
                            <div>
                                <h4 class="text-lg font-semibold">${project.title}</h4>
                                <p class="text-sm truncate">${project.description}</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-2">
                            <!-- Edit Button -->
                            <button data-id="${project.id}" 
                                    data-title="${project.title}"
                                    data-description="${project.description}"
                                    data-image="${project.image}"
                                    data-github="${project.github}"
                                    data-demourl="${project.demoUrl || ''}"
                                    data-techs="${(project.technologies || []).join(', ')}"
                                    class="edit-project-btn bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-full text-sm transition duration-300">
                                Editar <i class="fas fa-edit ml-1"></i>
                            </button>
                            <!-- Delete Button -->
                            <button data-id="${project.id}" class="delete-project-btn bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-full text-sm transition duration-300">
                                Eliminar <i class="fas fa-trash-alt ml-1"></i>
                            </button>
                        </div>
                    </div>
                `;
                currentProjectsList.insertAdjacentHTML('beforeend', projectItem);
            });

            // Añadir event listeners para botones de eliminar
            document.querySelectorAll('.delete-project-btn').forEach(button => {
                button.addEventListener('click', async (e) => {
                    const projectId = e.target.dataset.id;
                    try {
                        // La eliminación siempre apunta a la colección pública
                        await deleteDoc(doc(publicProjectsCollectionRef, projectId));
                        dashboardMessage.className = 'text-center mt-4 text-green-600';
                        dashboardMessage.textContent = 'Proyecto eliminado con éxito.';
                        setTimeout(() => { dashboardMessage.textContent = ''; }, 3000);
                    } catch (error) {
                        console.error("Error al eliminar proyecto: ", error);
                        dashboardMessage.className = 'text-center mt-4 text-red-600';
                        dashboardMessage.textContent = 'Error al eliminar el proyecto.';
                    }
                });
            });

            // Añadir event listeners para botones de editar
            document.querySelectorAll('.edit-project-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    // Obtener los datos del proyecto desde los atributos data-
                    const projectData = {
                        id: e.target.dataset.id,
                        title: e.target.dataset.title,
                        description: e.target.dataset.description,
                        image: e.target.dataset.image,
                        github: e.target.dataset.github,
                        demoUrl: e.target.dataset.demourl, // Usar el nuevo data-demourl
                        technologies: e.target.dataset.techs // Las tecnologías ya están como cadena
                    };
                    openEditProjectModal(projectData);
                });
            });
        }

        // Función para abrir el modal de edición y precargar los datos
        function openEditProjectModal(project) {
            editProjectId.value = project.id;
            editProjectTitle.value = project.title;
            editProjectDescription.value = project.description;
            editProjectImage.value = project.image;
            editProjectGithub.value = project.github;
            editProjectDemoUrl.value = project.demoUrl;
            editProjectTechs.value = project.technologies; // Ya es una cadena

            openModal(editProjectModal);
        }

        // Función para filtrar proyectos basada en el término de búsqueda
        function filterProjects(searchTerm) {
            const lowerCaseSearchTerm = searchTerm.toLowerCase();
            const filtered = allProjects.filter(project => {
                return project.title.toLowerCase().includes(lowerCaseSearchTerm) ||
                       project.description.toLowerCase().includes(lowerCaseSearchTerm);
            });
            renderProjects(filtered);
        }

        // Función para cambiar el tema (modo claro/oscuro)
        function toggleTheme() {
            const isDarkMode = document.body.classList.contains('dark-mode');
            if (isDarkMode) {
                document.body.classList.remove('dark-mode');
                localStorage.setItem('theme', 'light');
                themeToggleBtn.querySelector('i').classList.remove('fa-sun');
                themeToggleBtn.querySelector('i').classList.add('fa-moon');
            } else {
                document.body.classList.add('dark-mode');
                localStorage.setItem('theme', 'dark');
                themeToggleBtn.querySelector('i').classList.remove('fa-moon');
                themeToggleBtn.querySelector('i').classList.add('fa-sun');
            }
        }

        // Función para aplicar el tema guardado al cargar la página
        function applySavedTheme() {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-mode');
                themeToggleBtn.querySelector('i').classList.remove('fa-moon');
                themeToggleBtn.querySelector('i').classList.add('fa-sun');
            } else {
                // Por defecto es modo claro o si savedTheme es 'light'
                document.body.classList.remove('dark-mode');
                themeToggleBtn.querySelector('i').classList.remove('fa-sun');
                themeToggleBtn.querySelector('i').classList.add('fa-moon');
            }
        }


        document.addEventListener('DOMContentLoaded', async () => {
            // Aplicar el tema guardado inmediatamente al cargar el DOM
            applySavedTheme();

            // Animación de scroll suave
            const scrollLinks = document.querySelectorAll('.scroll-link');
            scrollLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href').substring(1);
                    const targetSection = document.getElementById(targetId);

                    if (targetSection) {
                        // Desplazar suavemente a la sección, ajustando por la altura del navbar
                        window.scrollTo({
                            top: targetSection.offsetTop - document.querySelector('nav').offsetHeight,
                            behavior: 'smooth'
                        });
                    }
                });
            });

            // Ocultar la animación de carga cuando la página esté completamente cargada
            const loaderOverlay = document.getElementById('loader-overlay');
            window.addEventListener('load', () => {
                loaderOverlay.style.opacity = '0';
                setTimeout(() => {
                    loaderOverlay.style.display = 'none';
                }, 500); // Espera a que la transición de opacidad termine
            });


            // --- Firebase Initialization and Auth ---
            try {
                const app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);

                // ! Mover la inicialización de publicProjectsCollectionRef aquí
                // Referencia a la colección pública donde se guardarán todos los proyectos
                publicProjectsCollectionRef = collection(db, `artifacts/${appId}/public/data/projects`);


                // Event Listeners para abrir/cerrar modales
                openLoginModalBtn.addEventListener('click', () => openModal(loginModal));
                closeLoginModalBtn.addEventListener('click', () => closeModal(loginModal));
                openDashboardModalBtn.addEventListener('click', () => openModal(dashboardModal));
                closeDashboardModalBtn.addEventListener('click', () => closeModal(dashboardModal));

                // Nuevos Event Listeners para el modal de contacto
                openContactModalBtn.addEventListener('click', () => openModal(contactModal));
                closeContactModalBtn.addEventListener('click', () => closeModal(contactModal));

                // Nuevos Event Listeners para el modal de edición
                closeEditProjectModalBtn.addEventListener('click', () => closeModal(editProjectModal));

                // Event Listener para el botón de cambio de tema
                themeToggleBtn.addEventListener('click', toggleTheme);


                // Cerrar modales al hacer clic fuera
                loginModal.addEventListener('click', (e) => {
                    if (e.target === loginModal) closeModal(loginModal);
                });
                dashboardModal.addEventListener('click', (e) => {
                    if (e.target === dashboardModal) closeModal(dashboardModal);
                });
                contactModal.addEventListener('click', (e) => {
                    if (e.target === contactModal) closeModal(contactModal);
                });
                editProjectModal.addEventListener('click', (e) => {
                    if (e.target === editProjectModal) closeModal(editProjectModal);
                });


                // Escuchar cambios en la autenticación
                onAuthStateChanged(auth, (user) => {
                    userId = user ? user.uid : null; // Actualizar userId con el UID del usuario o null

                    // Actualizar UI del administrador
                    updateAdminUI(user && user.uid === ADMIN_USER_ID);

                    document.getElementById('current-user-id').textContent = userId || 'No autenticado'; // Mostrar UID

                    // Siempre suscribirse a los proyectos públicos para mostrarlos en la página principal y el dashboard
                    // Esta suscripción se establece una vez al cargar la página y no se cancela.
                    onSnapshot(publicProjectsCollectionRef, (snapshot) => {
                        allProjects = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })); // Almacenar todos los proyectos
                        renderProjects(allProjects); // Renderizar todos los proyectos inicialmente
                        renderDashboardProjects(allProjects); // Para la lista dentro del dashboard modal
                    }, (error) => {
                        console.error("Error cargando proyectos:", error);
                        document.getElementById('projects-container').innerHTML = '<p class="text-center col-span-full">Error al cargar proyectos. Verifique su conexión o permisos.</p>';
                    });
                });

                // Event listener para el campo de búsqueda
                projectSearchInput.addEventListener('input', (e) => {
                    filterProjects(e.target.value);
                });


                // Formulario de inicio de sesión
                loginForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const email = document.getElementById('login-email').value;
                    const password = document.getElementById('login-password').value;

                    try {
                        const userCredential = await signInWithEmailAndPassword(auth, email, password);
                        console.log("Sesión iniciada con email/password:", userCredential.user.uid);
                        loginMessage.className = 'text-center mt-4 text-green-600';
                        loginMessage.textContent = '¡Inicio de sesión exitoso!';

                        if (userCredential.user.uid === ADMIN_USER_ID) {
                            closeModal(loginModal); // Cerrar login modal
                            openModal(dashboardModal); // Abrir dashboard modal
                        } else {
                            loginMessage.className = 'text-center mt-4 text-red-600';
                            loginMessage.textContent = 'Credenciales correctas, pero no eres el usuario administrador. Cerrando sesión...';
                            await signOut(auth); // Desconectar al usuario no-admin
                        }
                        loginForm.reset(); // Limpiar formulario después del intento
                    } catch (error) {
                        console.error("Error al iniciar sesión:", error.code, error.message);
                        loginMessage.className = 'text-center mt-4 text-red-600';
                        loginMessage.textContent = 'Error al iniciar sesión: ' + error.message;
                    }
                });

                // Envío del formulario del Dashboard (siempre publica en la colección pública)
                addProjectForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const title = document.getElementById('project-title').value;
                    const description = document.getElementById('project-description').value;
                    const image = document.getElementById('project-image').value;
                    const github = document.getElementById('project-github').value;
                    const demoUrl = document.getElementById('project-demo-url').value; // Obtener el valor del nuevo campo
                    const technologies = document.getElementById('project-techs').value.split(',').map(tech => tech.trim()).filter(tech => tech !== '');
                    

                    try {
                        // Solo el administrador autenticado puede agregar proyectos
                        if (auth.currentUser && auth.currentUser.uid === ADMIN_USER_ID) {
                            await addDoc(publicProjectsCollectionRef, { // Se agrega directamente a la colección pública
                                title,
                                description,
                                image,
                                github,
                                technologies,
                                demoUrl, // Añadir el campo demoUrl
                                createdAt: new Date()
                            });
                            addProjectForm.reset();
                            dashboardMessage.className = 'text-center mt-4 text-green-600';
                            dashboardMessage.textContent = '¡Proyecto agregado con éxito!';
                            setTimeout(() => { dashboardMessage.textContent = ''; }, 3000);
                        } else {
                            dashboardMessage.className = 'text-center mt-4 text-red-600';
                            dashboardMessage.textContent = 'Error: No tiene permisos para agregar proyectos. Por favor, inicie sesión como administrador.';
                            await signOut(auth); // Asegurar que el usuario no autorizado se desconecte
                            closeModal(dashboardModal);
                            openModal(loginModal);
                        }
                    } catch (error) {
                        console.error("Error al agregar proyecto: ", error);
                        dashboardMessage.className = 'text-center mt-4 text-red-600';
                        dashboardMessage.textContent = 'Error al agregar el proyecto.';
                    }
                });

                // Envío del formulario de Edición de Proyecto
                editProjectForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const projectId = editProjectId.value;
                    const updatedTitle = editProjectTitle.value;
                    const updatedDescription = editProjectDescription.value;
                    const updatedImage = editProjectImage.value;
                    const updatedGithub = editProjectGithub.value;
                    const updatedDemoUrl = editProjectDemoUrl.value;
                    const updatedTechnologies = editProjectTechs.value.split(',').map(tech => tech.trim()).filter(tech => tech !== '');

                    try {
                        if (auth.currentUser && auth.currentUser.uid === ADMIN_USER_ID) {
                            const projectDocRef = doc(publicProjectsCollectionRef, projectId);
                            await updateDoc(projectDocRef, {
                                title: updatedTitle,
                                description: updatedDescription,
                                image: updatedImage,
                                github: updatedGithub,
                                demoUrl: updatedDemoUrl,
                                technologies: updatedTechnologies,
                                updatedAt: new Date() // Opcional: añadir un campo de fecha de actualización
                            });
                            editDashboardMessage.className = 'text-center mt-4 text-green-600';
                            editDashboardMessage.textContent = 'Proyecto actualizado con éxito.';
                            setTimeout(() => { 
                                editDashboardMessage.textContent = '';
                                closeModal(editProjectModal); // Cerrar el modal de edición
                            }, 3000);
                        } else {
                            editDashboardMessage.className = 'text-center mt-4 text-red-600';
                            editDashboardMessage.textContent = 'Error: No tiene permisos para editar proyectos. Por favor, inicie sesión como administrador.';
                            // Opcional: Forzar cierre de sesión si no es el admin
                            // await signOut(auth);
                            // closeModal(editProjectModal);
                            // openModal(loginModal);
                        }
                    } catch (error) {
                        console.error("Error al actualizar proyecto: ", error);
                        editDashboardMessage.className = 'text-center mt-4 text-red-600';
                        editDashboardMessage.textContent = 'Error al actualizar el proyecto.';
                    }
                });


                // Envío del formulario de Contacto (en el modal)
                contactFormModal.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    // Aquí puedes añadir la lógica para enviar el formulario de contacto.
                    // Por ahora, solo mostraremos un mensaje de éxito/error simulado.
                    
                    const nombre = document.getElementById('nombre-contact-modal').value;
                    const email = document.getElementById('email-contact-modal').value;
                    const mensaje = document.getElementById('mensaje-contact-modal').value;

                    // Simulación de envío
                    try {
                        // Aquí iría tu lógica real de envío (e.g., fetch a una API, Firebase Cloud Function, etc.)
                        console.log(`Mensaje de contacto recibido:\nNombre: ${nombre}\nEmail: ${email}\nMensaje: ${mensaje}`);
                        
                        contactMessage.className = 'text-center mt-4 text-green-600';
                        contactMessage.textContent = '¡Mensaje enviado con éxito!';
                        contactFormModal.reset();
                        setTimeout(() => { 
                            contactMessage.textContent = ''; 
                            closeModal(contactModal); // Cerrar el modal después de un tiempo
                        }, 3000);

                    } catch (error) {
                        console.error("Error al enviar mensaje de contacto: ", error);
                        contactMessage.className = 'text-center mt-4 text-red-600';
                        contactMessage.textContent = 'Error al enviar el mensaje. Inténtelo de nuevo.';
                    }
                });


                // Botón de cerrar sesión
                logoutBtn.addEventListener('click', async () => {
                    try {
                        await signOut(auth);
                        console.log("Sesión cerrada.");
                        // onAuthStateChanged se encargará de reconfigurar la UI y los listeners
                        closeModal(dashboardModal); // Asegurarse de cerrar el dashboard
                        openModal(loginModal); // Reabrir el modal de login
                    } catch (error) {
                        console.error("Error al cerrar sesión: ", error);
                    }
                });

            } catch (error) {
                console.error("Error general de inicialización de Firebase:", error);
                closeModal(loginModal);
                closeModal(dashboardModal);
                closeModal(contactModal); // Asegurarse de cerrar el modal de contacto también
                closeModal(editProjectModal); // Asegurarse de cerrar el modal de edición también
                adminIconNavItem.classList.remove('hidden');
                dashboardNavItem.classList.add('hidden');
                document.getElementById('projects-container').innerHTML = '<p class="text-center col-span-full">Error al inicializar la aplicación. Verifique su configuración de Firebase.</p>';
            }
        });

        // Event listener para prevenir algunas combinaciones de teclas comunes (PrintScreen, F12, Ctrl+Shift+I/J)
        document.addEventListener('keydown', function(e) {
            // Prevenir F12
            if (e.key === 'F12') {
                e.preventDefault();
                console.log('F12 deshabilitado.');
                // Puedes mostrar un mensaje al usuario aquí, por ejemplo:
                // showMessage('La depuración está deshabilitada para esta página.');
            }
            // Prevenir Ctrl+Shift+I (Inspector de elementos)
            if (e.ctrlKey && e.shiftKey && e.key === 'I') {
                e.preventDefault();
                console.log('Ctrl+Shift+I deshabilitado.');
            }
            // Prevenir Ctrl+Shift+J (Consola)
            if (e.ctrlKey && e.shiftKey && e.key === 'J') {
                e.preventDefault();
                console.log('Ctrl+Shift+J deshabilitado.');
            }
            // Prevenir PrintScreen (puede variar entre navegadores y sistemas operativos)
            if (e.key === 'PrintScreen' || e.keyCode === 44) { // keyCode 44 es PrintScreen
                e.preventDefault();
                console.log('Captura de pantalla deshabilitada.');
            }
        });

        // Opcional: Detectar si las herramientas de desarrollador están abiertas (no confiable al 100%)
        // setTimeout(function(){
        //     const devtools = /devtool/i.test(window.navigator.userAgent) || /inspector/i.test(window.navigator.userAgent);
        //     if(devtools){
        //         console.log("Herramientas de desarrollador abiertas.");
        //         // Puedes redirigir o mostrar un mensaje aquí
        //         // window.location.href = 'about:blank';
        //     }
        // }, 1000);


    </script>
</body>
</html>
